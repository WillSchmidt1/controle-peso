<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Controle de Peso</title>

<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body { background-color: #f4f6f9; }
.card { border-radius: 15px; }
canvas { background: white; padding: 10px; border-radius: 15px; }
</style>
</head>
<body>

<div class="container py-4">

<h2 class="text-center mb-4">üìä Controle Pessoal</h2>

<!-- Meta -->
<div class="card p-3 mb-4 shadow-sm">
<h5>Meta de Peso (kg)</h5>
<div class="input-group">
<input type="number" id="metaPeso" step="0.1" class="form-control">
<button class="btn btn-primary" onclick="salvarMeta()">Salvar</button>
</div>
</div>

<!-- Abas -->
<ul class="nav nav-tabs mb-3" id="tabs">
<li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#peso">Peso</button></li>
<li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#refeicao">Refei√ß√£o</button></li>
<li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#atividade">Atividade</button></li>
<li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#bebida">Bebida</button></li>
</ul>

<div class="tab-content">

<!-- PESO -->
<div class="tab-pane fade show active" id="peso">
<div class="card p-3 shadow-sm">
<input type="number" id="pesoInput" step="0.1" class="form-control mb-2" placeholder="Peso (kg)">
<button class="btn btn-success w-100" onclick="salvarPeso()">Salvar Peso</button>
</div>
</div>

<!-- REFEI√á√ÉO -->
<div class="tab-pane fade" id="refeicao">
<div class="card p-3 shadow-sm">
<input type="date" id="refData" class="form-control mb-2">
<input type="time" id="refHora" class="form-control mb-2">
<select id="refTipo" class="form-select mb-2">
<option>Caf√©</option>
<option>Almo√ßo</option>
<option>Jantar</option>
<option>Lanche pela manh√£</option>
<option>Lanche a tarde</option>
<option>Lanche a noite</option>
</select>
<textarea id="refDescricao" class="form-control mb-2" placeholder="Descri√ß√£o"></textarea>
<button class="btn btn-success w-100" onclick="salvarRefeicao()">Salvar</button>
</div>
</div>

<!-- ATIVIDADE -->
<div class="tab-pane fade" id="atividade">
<div class="card p-3 shadow-sm">
<input type="date" id="atvData" class="form-control mb-2">
<textarea id="atvDescricao" class="form-control mb-2" placeholder="Descri√ß√£o da atividade"></textarea>
<button class="btn btn-success w-100" onclick="salvarAtividade()">Salvar</button>
</div>
</div>

<!-- BEBIDA -->
<div class="tab-pane fade" id="bebida">
<div class="card p-3 shadow-sm">
<input type="datetime-local" id="bebDataHora" class="form-control mb-2">
<input type="number" step="0.01" id="bebQtd" class="form-control mb-2" placeholder="Quantidade (litros)">
<select id="bebTipo" class="form-select mb-2">
<option>Cerveja</option>
<option>Vinho</option>
<option>Whisky</option>
</select>
<button class="btn btn-success w-100" onclick="salvarBebida()">Salvar</button>
</div>
</div>

</div>

<hr class="my-4">

<h4 class="mb-3">Gr√°ficos</h4>

<div class="card p-3 mb-4 shadow-sm">
<canvas id="grafico1"></canvas>
</div>

<div class="card p-3 mb-4 shadow-sm">
<canvas id="grafico2"></canvas>
</div>

<div class="card p-3 mb-4 shadow-sm">
<canvas id="grafico3"></canvas>
</div>

<div class="card p-3 shadow-sm">
<canvas id="grafico4"></canvas>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
let pesos = JSON.parse(localStorage.getItem("pesos")) || [];
let atividades = JSON.parse(localStorage.getItem("atividades")) || [];
let bebidas = JSON.parse(localStorage.getItem("bebidas")) || [];
let meta = localStorage.getItem("meta") || null;

document.getElementById("refData").valueAsDate = new Date();
document.getElementById("refHora").value = new Date().toTimeString().slice(0,5);
document.getElementById("atvData").valueAsDate = new Date();
document.getElementById("bebDataHora").value = new Date().toISOString().slice(0,16);
if(meta) document.getElementById("metaPeso").value = meta;

function salvarMeta(){
meta = document.getElementById("metaPeso").value;
localStorage.setItem("meta", meta);
atualizarGraficos();
}

function salvarPeso(){
let agora = new Date();
pesos.push({peso: parseFloat(document.getElementById("pesoInput").value), data: agora.toISOString()});
localStorage.setItem("pesos", JSON.stringify(pesos));
atualizarGraficos();
}

function salvarRefeicao(){
alert("Refei√ß√£o salva (armazenamento simplificado nesta vers√£o).");
}

function salvarAtividade(){
atividades.push({data: document.getElementById("atvData").value});
localStorage.setItem("atividades", JSON.stringify(atividades));
atualizarGraficos();
}

function salvarBebida(){
bebidas.push({data: document.getElementById("bebDataHora").value});
localStorage.setItem("bebidas", JSON.stringify(bebidas));
atualizarGraficos();
}

function atualizarGraficos(){
let datas = pesos.map(p=>new Date(p.data).toLocaleDateString());
let valores = pesos.map(p=>p.peso);
let linhaMeta = meta ? Array(valores.length).fill(meta) : [];

new Chart(document.getElementById("grafico1"), {
type:"line",
data:{labels:datas,datasets:[
{label:"Peso", data:valores, borderWidth:2},
{label:"Meta", data:linhaMeta, borderDash:[5,5]}
]}
});
}

atualizarGraficos();
</script>

</body>
</html>
